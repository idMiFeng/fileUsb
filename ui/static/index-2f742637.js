import{a as ne,_ as T,u as ce,r as l,w as ie,o as G,b as h,c,d as u,e as s,f as t,g as d,h as a,i as g,t as r,j as O,k as H,n as j,F as K,E as F,l as re,p as $,m as ee,q as de,s as W,v as ue,x as q}from"./index-3f6ea9b1.js";const pe="/static/usb-8f638636.svg",Z="/static/usb2-eb79e6c4.svg",fe="/static/cipan-0fe0b060.svg",L=n=>{if(n===0)return"0 B";var o=1024,f=["B","KB","MB","GB","PB","TB","EB","ZB","YB"],y=Math.floor(Math.log(n)/Math.log(o));return(n/Math.pow(o,y)).toPrecision(3)+""+f[y]},_e="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAAAXNSR0IArs4c6QAAAg5JREFUeF7tmz1rFFEUQM+dZBNciO6HChHBMpj8AMEuaBVsLKxsldm04j/YOthGMSDYKQQhRgSxkw0RLFSif0BFiywk0SrJu7KmsZGZIW+G55s77by9H2ff3DMDM0LND6l5/xgA2wE1J3B0CTzc6XBw2Ee4AZwpyGQT5A1p+27B3wWxXFjem0X2t45fjSz9jxCE5eE6wsLxAQCa3KLXWvESq6IgwoPhV5RznvJ9RxtX6E198hSv9DDC/aF6zvKMtHPdc8zSwpUBAEReoWzh3E5plf8deCzZRmTA7da7ovnKAVC0Cn/rP4L2SbtP84aMDcBR385dYvH02zwQ4gSAvibtXq0xgJGS9TK97kYWhEh3wKhtuUPavpcLQHNynLMnTzDZGCOR6B8Q94D3wKPP12RFWo9/6XS7mQUqyvOqzMuF1X1tToxH2WCOpgYys+a0Btv+Xyx+ysXn6vtWOAf4cJYYANsBdgnYDLAhGM5Mrr4Ss4BZwCxgFjALVD97w8loFjALmAXMAmaBcGZy9ZWYBcwCZgGzgFmg+tkbTkazgFnALGAWMAuEM5Orr8QsYBYwC9TcAjNrbjcRmap+/ASR8cdoCK6Dpw8mguipUBGrMvdCZ53DwyczhRIHsfhQOf/ntdC5l9pxB/QVbgqcCqK68or4BjxpJCx9WJAv0b8Xm8XRAGQRiv287YDY/+Gs/n4DEXrR/DuWr2EAAAAASUVORK5CYII=",ve="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAAAXNSR0IArs4c6QAABIlJREFUeF7tm0+I3FQcx7+/rIKI4E5mV3pcEUFBd6kI9bjFtpuMIl4qIi2KLS4oupkqoii0C0UsrU2mYPFPq1URDx48dZMpC/ZS9FKrPdiDh86th91J6k2pm59kd2aZP5k/SV6SyZAck9/fz3t5ee/l9wgDrpJxe6+LjcckSLMM3gXg0UE6cT8n0I8rWuEFEX6onxG14lwA88siHIm2IQqCL4CSsb7LBa0S6D7RgYu0JwKCLwDVsFlkoHHaigqhC4BasU+C8U6cQYu2HQVCG4CS7hxk4m97BGiC+RLD/V10An72iCZ+7rxPTMtMfNRXPuTA2AZANezvAbzU5YBxwCzL3rNELkVfm/cDwLyxWyLpaQZ9KApCJ4A/Oz9zzLxslYvHEsm84aQfAKs8fVmp2B8R430RELYBPK87k/8SO51GJZKevLg0eXWUAHixqLp9AoR3o0LYBtCLuqnJfecKcYAZ1AOaPlXDOQXw21EgZBrAZk8wHB1gLSyEzANovA5nQHgzDISxAOAlXjLsTxl4PSiEsQHQgPAZA4tBIIwVAC9xpeJ8ScyHh4UwdgC2eoLzNYNfGQbCWAJovA7fMXDAD4I3o/QmVN6zbAEgXrSWil8MO/dQjfoPAL3YKZ9ZAI1ENlsu4DXfKj/yAPadWn9k4i7pRsAkhxYfeQBbMzz7FwBPDZ1VAMFMAFAq9deI6fMAeQ0tmgkAm70gpt2pzADY+pzV98Klh1ziHUM3cYsgEXXtIGUKQJikW3X8NnhzAKM+EYra6nkPaCGQvwI+P3nyMSAfA0Z8NZgPggIJxD4Ienv4Ek3sZ2A/gGmBsfczVQO75xh8pbmx0Us4dgCqvv4BSDqeUOJtbgg4u6LJb/TzHT8Aw74JYCYNAADWTE1+IFUA/TYgE4By2dTk3ekCqDgHmfmTBN//Zr41Bk5amnw2VQCec0V3Zoj4WWaeSqDVAXCNwdVqefrWIH+xjwGDAkj7eQ4gXwt0V7zli6F8MRTDYqh02n7cpY2iiEFv7d6pK1cX6Y4IW7EPgorhPEfgMoC2308Rg68R6KcVrXAkoh3vB0tX1avQMUCt2CfA/tVaUYMXUaEWP4AY64pF1CjGDqBf0WLUHsBMD1rlQi2KnfgB6M6MRDjaqyIjZPA1ZnfZKk9dCKm/rRY7gKYnbz0A/CdkWTxokyMIlMQABAkqSdkcQNyfwSRbM4yvvAcM2wP2fGzff/c9uN1JmYE5S5Ovh6Gfto5i2LME/NEZx51/MLn6nvy3d7/zwIQnPNumQPSVuVQ4lHYyYfyrFec8mF/t0L1uavJc8147gB7nBBmsWFqxGiaItHQUo75AIKvLP9E35lJhu4q0DYBi1A8R6FyPoKvM/CvghqnTS5CDNE9EXnXZgp9TBh+2tOJ53x7g3VQN+6JXmpNgxEm6WjE1+ZlWh5k/OBmEnt/xH18AC2ecOcnlVQAJbXMHSSOU7Lor0Z7qW4WuL0LfA1GKXj/mV2YWKoSUlAYtqQeeCFNP1/dBop3M/AQRdgL0cEq5DOmW/2LGNSL6DS5fM48UL/VT/B8K0p5u1JiUAQAAAABJRU5ErkJggg==";var ge="http:///";const se=ne.create({baseURL:ge,timeout:6e4});se.interceptors.request.use(function(n){return n},function(n){return Promise.reject(n)});se.interceptors.response.use(function(n){return n.data},function(n){return console.log(n),Promise.reject(n)});const P=n=>($("data-v-12e79fbe"),n=n(),ee(),n),he={class:"contianer"},me={class:"filelist-title"},Ae={class:"multiChoose"},ke=P(()=>s("div",{class:"title"},"文件列表",-1)),ye={class:"filelist-content"},be=["onClick"],Be={key:0,class:"typeIcon",style:{"padding-right":"22px"}},xe=P(()=>s("img",{src:_e,alt:""},null,-1)),we=[xe],Ce={key:1,class:"typeIcon",style:{"padding-right":"22px"}},Se=P(()=>s("img",{src:ve,alt:""},null,-1)),Ie=[Se],De={key:0,class:"show-upload-btn"},Ee=["src"],Le={class:"process"},Me={__name:"index",props:{message:{type:String,default:""},percentage:{type:Number,default:0},socket:{type:Object,default:""},filemsg:{type:Object,default:{}}},setup(n){const o=n;ce();const f=l(""),y=l(!1),m=l([{IsDir:!0,Name:"nnn",Root:"/a"},{IsDir:!0,Name:"nnn",Root:"/a"},{IsDir:!1,Name:"nnn",Root:"/a"},{IsDir:!1,Name:"nn.mp4",Root:"/a"}]),I=l([{IsDir:!0,Name:"nnn",Root:"/a"},{IsDir:!0,Name:"nnn",Root:"/a"},{IsDir:!1,Name:"nnn",Root:"/a"},{IsDir:!1,Name:"nn.mp4",Root:"/a"}]);l(),l([]);const D=l(!1),E=l(0),b=l(!1),k=l(!1),V=[{color:"#f56c6c",percentage:20},{color:"#e6a23c",percentage:40},{color:"#5cb87a",percentage:60},{color:"#1989fa",percentage:80},{color:"#6f7ad3",percentage:100}],Y=()=>{_.value=[],B.value=[],w.value=!1,k.value=!k.value,k.value?m.value=m.value.filter((e,v)=>!e.isDir):m.value=I.value};let _=l([]),B=l([]);const X=(e,v,z)=>{let M=e.path;if(!e.isDir){if(!_.value.includes(M))_.value.push(M);else{let U=_.value.indexOf(M);_.value.splice(U,1)}if(B.value.includes(e.name)){let U=B.value.indexOf(e.name);B.value.splice(U,1)}else B.value.push(e.name)}};ie(()=>B.value.length,e=>{e===m.value.length?b.value=!0:b.value=!1});const p=e=>(B.value.includes(e.row.name)||w.value)&&!e.row.isDir&&k.value?(w.value&&(_.value=[],m.value.forEach((v,z)=>{let M=v.path;_.value.push(M)})),"selected-row"):"";let x;const N=()=>{console.log(_.value),_.value.length?F.confirm("确认复制吗","提示",{confirmButtonText:"确认",cancelButtonText:"取消"}).then(()=>{D.value=!0,x=setInterval(()=>{E.value<90?E.value+=15:clearInterval(x)},1e3),o.socket.send(JSON.stringify({type:"copy",path:_.value})),o.socket.onmessage=e=>{e=JSON.parse(e.data),e.op==="copy"&&setTimeout(()=>{x&&clearInterval(x),D.value=!1,E.value=0,re({type:"success",message:"复制成功"})},1500)}}).catch(()=>{}):F.alert("还没有选择需要复制的文件","提示",{confirmButtonText:"确认"})};let w=l(!1);const A=()=>{w.value=!0};let R=[],C=[];const J=async e=>{if(e.isDir){R.push(e.path),o.socket.send(JSON.stringify({type:"info",mountpoint:e.path})),C.push(e.path),o.socket.onmessage=v=>{v=JSON.parse(v.data),v.op==="info"&&(m.value=v.data,I.value=v.data)};return}(e.name.indexOf(".mp4")>-1||e.name.indexOf(".mov")>-1||e.name.indexOf(".avi")>-1||e.name.indexOf(".mkv")>-1||e.name.indexOf(".wmv")>-1||e.name.indexOf(".flv")>-1||e.name.indexOf(".webm")>-1)&&!k.value&&(y.value=!0,f.value="http:////api/download?path="+e.path)},i=()=>{R.length!=0&&(o.socket.send(JSON.stringify({type:"info",mountpoint:C[C.length-2]})),o.socket.onmessage=e=>{e=JSON.parse(e.data),e.op==="info"&&(m.value=e.data,I.value=e.data)},C.pop(),R.pop())};return G(()=>{console.log(o.filemsg),o.socket.send(JSON.stringify({type:"info",mountpoint:o.filemsg.mountpoint})),C.push(o.filemsg.mountpoint),o.socket.onmessage=e=>{e=JSON.parse(e.data),e.op==="info"&&(m.value=e.data,I.value=e.data)}}),(e,v)=>{const z=h("ArrowLeft"),M=h("el-icon"),U=h("el-button"),te=h("el-table-column"),oe=h("el-table"),ae=h("el-dialog"),le=h("el-progress");return c(),u(K,null,[s("div",he,[s("div",me,[s("div",Ae,[t(k)?(c(),u("span",{key:0,onClick:A},"全选")):(c(),u("span",{key:1,onClick:i},[d(M,null,{default:a(()=>[d(z)]),_:1})]))]),ke,s("div",{class:"upload",onClick:Y},[d(U,{type:"primary",class:"ml-2"},{default:a(()=>[g(r(t(k)?"取消":"选择"),1)]),_:1})])]),s("div",ye,[d(oe,{data:t(m),style:{width:"100%",background:"'#000'","border-radius":"8px"},height:"910",showHeader:!1,"row-class-name":p,onRowClick:X},{default:a(()=>[d(te,null,{default:a(Q=>[s("div",{style:{display:"flex","align-items":"center",overflow:"hidden","text-overflow":"ellipsis","white-space":"nowrap"},onClick:vs=>J(Q.row)},[Q.row.isDir?(c(),u("div",Be,we)):(c(),u("div",Ce,Ie)),g(" "+r(Q.row.name),1)],8,be)]),_:1})]),_:1},8,["data"])]),t(k)?(c(),u("div",De,[d(U,{size:"large",type:"primary",class:"ml-2",onClick:N},{default:a(()=>[g("复制")]),_:1})])):O("",!0),d(ae,{modelValue:t(y),"onUpdate:modelValue":v[0]||(v[0]=Q=>H(y)?y.value=Q:null),title:"视频",width:"700","align-center":"","close-on-click-modal":!1},{default:a(()=>[s("video",{style:{width:"100%",height:"500px","object-fit":"cover"},src:t(f),muted:"",controls:"",autoplay:""},null,8,Ee)]),_:1},8,["modelValue"])]),t(D)?(c(),u("div",{key:0,class:j(["el-overlay",{overlay:t(D)}])},[s("div",Le,[d(le,{type:"circle",percentage:t(E),color:V},null,8,["percentage"])])],2)):O("",!0)],64)}}},Ne=T(Me,[["__scopeId","data-v-12e79fbe"]]);const S=n=>($("data-v-cf5ad578"),n=n(),ee(),n),Ue={key:0,class:"container-portrait"},Re={key:0,class:"USB"},Qe={style:{"font-size":"45px","font-weight":"bold"}},Ye=S(()=>s("div",{style:{"font-size":"20px",color:"aliceblue"}},"点击图标可返回上一级",-1)),ze={key:1,class:"USB-info"},Oe=S(()=>s("div",{class:"cell-item"},"磁盘名",-1)),Ve=S(()=>s("div",{class:"cell-item"},"分区",-1)),Xe=S(()=>s("div",{class:"cell-item"},"存储设备类型",-1)),Je=S(()=>s("div",{class:"cell-item"},"USB文件大小",-1)),Ke=S(()=>s("div",{class:"cell-item"},"已用空间大小",-1)),Fe=S(()=>s("div",{class:"cell-item"},"剩余空间大小",-1)),Ze={key:0,class:"main"},Pe=S(()=>s("div",{class:"usb-left"},[s("img",{src:Z,alt:""})],-1)),We={class:"usb-right"},qe={class:"usb-title"},Te={class:"usb-sub-name"},Ge={class:"usb-sub-title"},He={class:"usb-percentage"},je=["onClick"],$e=S(()=>s("div",{class:"usb-left"},[s("img",{src:Z,alt:""})],-1)),es={class:"usb-right"},ss={class:"usb-title"},ts={class:"usb-sub-name"},os={class:"usb-sub-title"},as={class:"usb-percentage"},ls=["onClick"],ns={class:"usb-left"},cs={key:0,src:Z,alt:""},is={key:1,src:fe,alt:""},rs={class:"usb-right"},ds={class:"usb-title"},us={class:"usb-sub-title"},ps={class:"usb-percentage"},fs={key:1},_s={__name:"index",setup(n){let o=l({device:"",mountpoint:"",fstype:"",total:"",free:"",used:""}),f=l("");l("");let y=l({});const m=l([]);var I=l({});const D=[{color:"#f56c6c",percentage:20},{color:"#e6a23c",percentage:40},{color:"#5cb87a",percentage:60},{color:"#1989fa",percentage:80},{color:"#82c91e",percentage:100}];let E=l(!1),b=l(!1);const k=()=>{ue.go(-1)},V=()=>{o.value.device||(E.value=!1,b.value=!1)},Y=p=>{F.confirm(`<div style="height:242px; line-height:44px; overflow:auto;"> 
    USB设备基本信息如下所示<br/>
         ${p.pname?`磁盘名:<span style="color:#67c23a">${p.pname}</span><br/>`:""}
        分区:<span style="color:#67c23a">${p.name}</span><br/>
        硬盘容量:<span style="color:#67c23a"> ${L(p.fsused)}/${L(p.fssize)}</span><br/>
        确定使用该U盘进行<span style="color:#67c23a">操作</span>吗?
        </div>      
    `,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",dangerouslyUseHTMLString:!0}).then(()=>{_.value=!0,y.value=p}).catch(()=>{})};let _=l(!1),B=l(0),X=l("");return G(async()=>{f.value=new WebSocket("ws:////api/ws"),f.value.onopen=()=>{f.value.send(JSON.stringify({type:"disk"}))},f.value.onmessage=p=>{if(p=JSON.parse(p.data),p.op=="disk"){if(E.value)return;let w=p.data;E.value=!0,b.value=!0,o.value={device:"",mountpoint:"",fstype:"",total:"",free:"",used:""};var x=[],N=1;I.value={};for(const A of w)I.value[A.pdevice]||(I.value[A.pdevice]="磁盘"+N,N++),x.push(A);m.value=w}},f.value.onerror=p=>{console.log(p)},f.value.onclose=p=>{console.log(p)}}),de(()=>{f.value&&(f.value.close(),f.value=null)}),(p,x)=>{const N=h("Loading"),w=h("el-icon"),A=h("el-descriptions-item"),R=h("el-descriptions"),C=h("el-progress"),J=h("el-dialog");return t(_)?(c(),u("div",fs,[t(_)?(c(),W(Ne,{key:0,socket:t(f),filemsg:t(y),percentage:t(B),message:t(X)},null,8,["socket","filemsg","percentage","message"])):O("",!0)])):(c(),u("div",Ue,[t(o).device?(c(),u("div",ze,[d(R,{class:"descriptions",column:1,border:""},{default:a(()=>[d(A,null,{label:a(()=>[Oe]),default:a(()=>[g(" "+r(t(o).name),1)]),_:1}),t(o).pname?(c(),W(A,{key:0},{label:a(()=>[Ve]),default:a(()=>[g(" "+r(t(o).pname),1)]),_:1})):O("",!0),d(A,null,{label:a(()=>[Xe]),default:a(()=>[g(" "+r(t(o).fstype),1)]),_:1}),d(A,null,{label:a(()=>[Je]),default:a(()=>[g(" "+r(t(o).total),1)]),_:1}),d(A,null,{label:a(()=>[Ke]),default:a(()=>[g(" "+r(t(o).used),1)]),_:1}),d(A,null,{label:a(()=>[Fe]),default:a(()=>[g(" "+r(t(o).free),1)]),_:1})]),_:1}),s("div",{class:"footer"},[s("div",{class:"back",onClick:k},"返回上一级")])])):(c(),u("div",Re,[s("img",{src:pe,alt:"",onClick:k}),s("div",Qe,[g(" 请插入需要插入的U盘.... "),d(w,{class:"is-loading"},{default:a(()=>[d(N)]),_:1})]),Ye])),d(J,{modelValue:t(b),"onUpdate:modelValue":x[0]||(x[0]=i=>H(b)?b.value=i:b=i),title:"选择USB设备",width:"90%",style:{"min-height":"50vh"},beforeClose:V},{default:a(()=>[(c(!0),u(K,null,q(t(m),i=>(c(),u("div",{class:"usb-card",key:i.device},[i.children?(c(),u("div",Ze,[Pe,s("div",We,[s("div",qe,[s("div",Te,r(i.name),1),s("div",Ge,"文件系统:"+r(i.fstype),1)]),s("div",He,[d(C,{color:D,percentage:parseInt(i["fsuse%"]),"stroke-width":30},{default:a(()=>[g(r(t(L)(i.fsused))+"/"+r(t(L)(i.fssize)),1)]),_:2},1032,["percentage"])])])])):(c(),u("div",{key:1,class:"main",onClick:e=>Y(i,"parent")},[$e,s("div",es,[s("div",ss,[s("div",ts,r(i.name),1),s("div",os,"文件系统:"+r(i.fstype),1)]),s("div",as,[d(C,{color:D,percentage:parseInt(i["fsuse%"]),"stroke-width":30},{default:a(()=>[g(r(t(L)(i.fsused))+"/"+r(t(L)(i.fssize)),1)]),_:2},1032,["percentage"])])])],8,je)),s("div",{class:j(["children",i.children?"":"avtive"])},[(c(!0),u(K,null,q(i.children,(e,v)=>(c(),u("div",{class:"children_card",key:v,onClick:z=>Y(e,"children")},[s("div",ns,[e.name?(c(),u("img",cs)):(c(),u("img",is))]),s("div",rs,[s("div",ds,[g(r(e.name)+" ",1),s("div",us," 文件系统:"+r(e.fstype),1)]),s("div",ps,[d(C,{color:D,percentage:parseInt(e["fsuse%"]),"stroke-width":30},{default:a(()=>[g(r(t(L)(e.fsused))+"/"+r(t(L)(e.fssize)),1)]),_:2},1032,["percentage"])])])],8,ls))),128))],2)]))),128))]),_:1},8,["modelValue"])]))}}},hs=T(_s,[["__scopeId","data-v-cf5ad578"]]);export{hs as default};
